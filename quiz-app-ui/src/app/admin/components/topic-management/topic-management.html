<app-header></app-header>

<div class="container">

  <!-- Page Header -->
  <div class="page-header">
    <h2>Topic Management</h2>

    <button
      mat-raised-button
      color="primary"
      (click)="openCreateDialog()">
      + Create Topic
    </button>
  </div>

  <!-- Loader -->
  <mat-progress-bar
    *ngIf="loading"
    mode="indeterminate">
  </mat-progress-bar>

  <!-- Topic Table -->
  <table
    mat-table
    [dataSource]="topics"
    class="mat-elevation-z2">

    <!-- Name -->
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef>
        Name
      </th>
      <td mat-cell *matCellDef="let t">
        {{ t.name }}
      </td>
    </ng-container>

    <!-- Description -->
    <ng-container matColumnDef="description">
      <th mat-header-cell *matHeaderCellDef>
        Description
      </th>
      <td mat-cell *matCellDef="let t">
        {{ t.description || '-' }}
      </td>
    </ng-container>

    <!-- Status -->
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef>
        Status
      </th>
      <td mat-cell *matCellDef="let t">
        <mat-chip
            [color]="t.isActive ? 'primary' : 'warn'"
            selected>
            {{ t.isActive ? 'Active' : 'Disabled' }}
        </mat-chip>
      </td>
    </ng-container>

    <!-- Actions -->
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>
        Actions
      </th>
      <td mat-cell *matCellDef="let t">
        <button mat-icon-button
                color="warn"
                *ngIf="t.isActive"
                (click)="disableTopic(t)">
            <mat-icon>block</mat-icon>
        </button>
      </td>
    </ng-container>

    <!-- Header & Rows -->
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>

    <tr
      mat-row
      *matRowDef="let row; columns: displayedColumns"
      [class.disabled-row]="!row.active">
    </tr>

  </table>

  <!-- Empty State -->
  <p class="empty" *ngIf="topics.length === 0 && !loading">
    No topics found
  </p>

</div>
